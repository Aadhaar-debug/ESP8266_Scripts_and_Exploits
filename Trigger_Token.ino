#include <ESP8266WiFi.h>
#include <ESP8266WebServer.h>

const char* ssid = "MyESPAP";         // Name of the access point
const char* password = "password123"; // Password for the access point

ESP8266WebServer server(80);

void handleRoot() {
  // Trigger the Canary Web Token here
  // Example: Send a GET request to a specific URL
  WiFiClient client;
  if (client.connect("your-web-server.com", 80)) {
    client.print("GET /your-web-token-endpoint HTTP/1.1\r\n");
    client.print("Host: your-web-server.com\r\n");
    client.print("Connection: close\r\n\r\n");
    client.flush();
  }
  
  // You can add additional actions or responses if needed
  server.send(200, "text/html", "Connected to ESP8266 access point");
}

void setup() {
  Serial.begin(115200);
  delay(10);

  // Set ESP8266 to access point mode
  WiFi.mode(WIFI_AP);

  // Create the access point
  WiFi.softAP(ssid, password);

  IPAddress apIP = WiFi.softAPIP();
  Serial.print("Access Point IP address: ");
  Serial.println(apIP);

  server.on("/", handleRoot);

  server.begin();
}

void loop() {
  server.handleClient();
}
